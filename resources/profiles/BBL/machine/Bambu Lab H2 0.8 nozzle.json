{
    "type": "machine",
    "name": "Bambu Lab H2 0.8 nozzle",
    "inherits": "Bambu Lab H2 0.4 nozzle",
    "from": "system",
    "setting_id": "GM040",
    "instantiation": "true",
    "nozzle_diameter": [
        "0.8"
    ],
    "printer_model": "Bambu Lab H2",
    "printer_variant": "0.8",
    "default_filament_profile": [
        "Bambu PLA Basic @BBL H2"
    ],
    "default_print_profile": "0.40mm Standard @BBL H2 0.8 nozzle",
    "max_layer_height": [
        "0.56"
    ],
    "min_layer_height": [
        "0.16"
    ],
    "retraction_length": [
        "3"
    ],
    "machine_start_gcode": ";===== machine: O1S T2 =========================\n;===== date: 2024/09/14 =====================\n\n;===== start to heat heatbead&hotend==========\nM1002 gcode_claim_action : 2\nM1002 set_filament_type:{filament_type[initial_no_support_extruder]}\nM104 S140\nM140 S[bed_temperature_initial_layer_single]\n\n;=====printer start sound ===================\nM17\nM400 S1\nM1006 S1\nM1006 A0 B10 L100 C37 D10 M60 E37 F10 N60\nM1006 A0 B10 L100 C41 D10 M60 E41 F10 N60\nM1006 A0 B10 L100 C44 D10 M60 E44 F10 N60\nM1006 A0 B10 L100 C0 D10 M60 E0 F10 N60\n\nM1006 A46 B10 L100 C43 D10 M70 E39 F10 N70\nM1006 A0 B10 L100 C0 D10 M60 E0 F10 N100\nM1006 A43 B10 L100 C0 D10 M60 E39 F10 N70\nM1006 A0 B10 L100 C0 D10 M60 E0 F10 N100\n\nM1006 A41 B10 L100 C0 D10 M100 E41 F10 N100\nM1006 A44 B10 L100 C0 D10 M100 E44 F10 N100\nM1006 A49 B10 L100 C0 D10 M100 E49 F10 N100\nM1006 A0 B10 L100 C0 D10 M100 E0 F10 N100\n\nM1006 A48 B10 L100 C44 D10 M100 E39 F10 N100\nM1006 A0 B10 L100 C0 D10 M60 E0 F10 N100\nM1006 A44 B10 L100 C0 D10 M90 E39 F10 N60\nM1006 A0 B10 L100 C0 D10 M60 E0 F10 N100\nM1006 A46 B10 L100 C43 D10 M100 E39 F10 N60\nM1006 W\nM18\n;=====printer start sound ===================\n\n;=====avoid end stop =================\nG91\nM17 Z0.3 ; lower the z-motor current\nG380 S2 Z30 F1200\nG380 S2 Z-25 F1200\nM17 D ; reset motor current to default\nG90\n\n;===== reset machine status =================\nM204 S10000\n\nM630 S0 P0\nM960 S5 P1 ; turn on logo lamp\n\nM220 S100 ;Reset Feedrate\nM221 S100 ;Reset Flowrate\nM73.2   R1.0 ;Reset left time magnitude\n\n;==== set airduct mode ==== \n\n{if (filament_type[initial_no_support_extruder]==\"PLA\") || (filament_type[initial_no_support_extruder]==\"PETG\") || (filament_type[initial_no_support_extruder]==\"TPU\") || (filament_type[initial_no_support_extruder]==\"PVA\") || (filament_type[initial_no_support_extruder]==\"PLA-CF\") || (filament_type[initial_no_support_extruder]==\"PETG-CF\")|| (filament_type[initial_no_support_extruder]==\"Support W\")}\n\nM145 P0 ; set airduct mode to cooling mode for cooling\nM106 P2 S178 ; turn on auxiliary fan for cooling\nM142 P1 R35 S40 U0.3 V0.5 ; set chamber autocooling\nM140 S0 ; stop heatbed from heating\nM191 S0 ; wait for chamber temp\nM106 P2 S0 ; turn off auxiliary fan\n{else}\nM145 P1 ; set airduct mode to heating mode for heating\nM106 P2 S0 ; turn off auxiliary fan\nM106 P3 S0 ; turn off chamber fan\n\n{endif}\n\n;===== tool head homing =====================\nM1002 gcode_claim_action : 13\n\nG28 X\nG91\nG1 Z5 F1200\nG90\nG0 X170 Y160 F30000\nG91\nG1 Z-5 F1200\n\n;M109 S100 H140\n\nM1015.5 S0; close extruder motor overload detect\nM400\nM83\nG1 E10 F1200\nG1 E-0.5 F30\nM400\nM18 E\nM400 S1\nM17 D\nM1015.5 S1; open extruder motor overload detect\n\nG28 Z P0 T300; home z with low precision,permit 300deg temperature\nM104 S140\n\n;===== mech mode fast check start =====================\nM1002 gcode_claim_action : 3\n\nG90\nG1 X170 Y160 F20000\nG1 Z5 F1200\nM400 P200\nM970.3 Q1 A7 K0 O3\nM974 Q1 S2 P0\n\n;M970.2 Q1 K1 W58 Z0.1\n;M974 S2\n\nG1 X170 Y160 F20000\nG1 Z5 F1200\nM400 P200\nM970.3 Q0 A7 K0 O3\nM974 Q0 S2 P0\n\n;M970.2 Q0 K1 W78 Z0.1\n;M974 S2\n\nM975 S1\nG1 F30000\nG1 X300 Y315\nG28 X ; re-home XY\n\nG1 Z4 F1200\n\nM104 S{nozzle_temperature_initial_layer[initial_extruder]}\n\n;===== prepare print temperature and material ==========\nM1002 gcode_claim_action : 24\n\nM400\nM211 X0 Y0 Z0 ;turn off soft endstop\nM975 S1 ; turn on input shaping\n\nG90\nG1 X150 Y320 F30000\nG1 Y336 F12000\nG1 X110.1 F30000\n\nM620 M ;enable remap\n\nM620.10 A0 F{filament_max_volumetric_speed[initial_no_support_extruder]/2.4053*60} H{nozzle_diameter[initial_no_support_extruder]} T{nozzle_temperature_range_high[initial_no_support_extruder]} P{nozzle_temperature_initial_layer[initial_no_support_extruder]}\nM620.10 A1 F{filament_max_volumetric_speed[initial_no_support_extruder]/2.4053*60} H{nozzle_diameter[initial_no_support_extruder]} T{nozzle_temperature_range_high[initial_no_support_extruder]} P{nozzle_temperature_initial_layer[initial_no_support_extruder]}\n\n{if filament_type[initial_no_support_extruder] == \"TPU\"}\n    M620.11 S0 L0 I[initial_no_support_extruder] E-{retraction_distances_when_cut[initial_no_support_extruder]} F{filament_max_volumetric_speed[initial_no_support_extruder]/2.4053*60}\n{else}\n    M620.11 S1 L0 I[initial_no_support_extruder] E-{retraction_distances_when_cut[initial_no_support_extruder]} F{filament_max_volumetric_speed[initial_no_support_extruder]/2.4053*60}\n{endif}\n\nM620 S[initial_no_support_extruder]A   ; switch material if AMS exist\nM1002 gcode_claim_action : 4\nM1002 set_filament_type:UNKNOWN\nM400\nT[initial_no_support_extruder]\nM400\nM628 S0\nM629\nM400\nM1002 set_filament_type:{filament_type[initial_no_support_extruder]}\nM621 S[initial_no_support_extruder]A\n\nM104 S{nozzle_temperature_initial_layer[initial_no_support_extruder]}\nM400\nM106 P1 S0\n\n;===== auto extrude cali start =========================\nM1002 gcode_claim_action : 8\nM975 S1\n\nG90\nM83\nT1000\nG1 X110.1 Y336 F10000\nM400\nM1002 set_filament_type:UNKNOWN\n\nM412 S1 ;  ===turn on  filament runout detection===\nM400 P10\nM620.3 W1; === turn on filament tangle detection===\nM400 S2\n\nM1002 set_filament_type:{filament_type[initial_no_support_extruder]}\n\n;M1002 set_flag extrude_cali_flag=1\nM1002 judge_flag extrude_cali_flag\n\nM622 J1\n    M109 S{nozzle_temperature[initial_extruder]}\n    G1 E10 F{outer_wall_volumetric_speed/2.4*60}\n    M983 F{outer_wall_volumetric_speed/2.4} A0.3 ; cali dynamic extrusion compensation\n\n    M106 P1 S255\n    M400 S5\n    M106 P1 S0\n    G1 X74.5 F5000\n    G1 X110.1 F5000\n\n    M1002 judge_last_extrude_cali_success\n    M622 J0\n        M983 F{outer_wall_volumetric_speed/2.4} A0.3 ; cali dynamic extrusion compensation\n        M106 P1 S255\n        M400 S5\n        M106 P1 S0\n        G1 X74.5 F5000\n        G1 X110.1 F5000\n    M623\nM623\n\nM104 S{nozzle_temperature_initial_layer[initial_extruder]-50}\nG1 X74.5 F5000\nG1 X110.1 F5000\nG1 X74.5 F10000\nG1 X110.1 F10000\nM106 P1 S255\n\nG1 X150 F20000 ;avoid collision\nG1 Y320 F20000 ;avoid collision\n\n;===== set chamber temperature ==========\n{if (overall_chamber_temperature >= 40)}\nM145 P1 ; set airduct mode to heating mode\nM141 S[overall_chamber_temperature] ; Let Chamber begin to heat\n{endif}\n\n;===== wipe nozzle ===============================\nM1002 gcode_claim_action : 14\n\nM975 S1\nM106 P1 S0 ; turn off fan\nM211 S; push soft endstop status\nM211 X0 Y0 Z0 ;turn off Z axis endstop\n\nG1 Z10 F1200\nG0 X226.5 Y330.75 F30000      ; move to exposed steel surface\nG1 Z5 F1200\n\nG28 Z P0 T300; home z with low precision,permit 300deg temperature\nG29.2 S0 ; turn off ABL\nG0 Z5 F20000\n\nG0 Z-0.2 F1200      ; stop the nozzle\nM106 P1 S255 ; turn on fan\nM109 S{nozzle_temperature_initial_layer[initial_extruder]-50}\n\nG91\nG2 I1 J0 X2 Y0 F2000.1\nG2 I-0.75 J0 X-1.5\nG2 I1 J0 X2\nG2 I-0.75 J0 X-1.5\nG2 I1 J0 X2\nG2 I-0.75 J0 X-1.5\nG2 I1 J0 X2\nG2 I-0.75 J0 X-1.5\nG2 I1 J0 X2\nG2 I-0.75 J0 X-1.5\n\nM109 S140\nM211 R; pop softend status\n;===== bed leveling ==================================\n\n    M1002 judge_flag g29_before_print_flag\n\n    G29.2 S1 ; turn on ABL\n\n    M190 S[bed_temperature_initial_layer_single]; ensure bed temp\n    M109 S140\n    M106 S0 ; turn off fan , too noisy\n\n    M622 J1\n        M1002 gcode_claim_action : 1\n        G90\n        G1 Z5 F1200\n        G1 X300 Y315 F20000\n        G29 A1 X{first_layer_print_min[0]} Y{first_layer_print_min[1]} I{first_layer_print_size[0]} J{first_layer_print_size[1]}\n        M400\n        M500 ; save cali data\n    M623\n\n    M1002 judge_flag g29_before_print_flag\n    M622 J0\n        G28\n    M623\n\n;===== nozzle load line ===============================\nG90\nM83\n;G1 X8 Y-0.5 F20000\n;G1 Z0.3 F1200\n;G1 E2 F300\n;G1 X248 E15 F6000\n;G1 Z1 F1200\nG1 Z5 F1200\nG1 X88 Y-0.5 F20000\nG1 Z0.3 F1200\n\nM109 S{nozzle_temperature[initial_extruder]}\n\nG1 E2 F300\nG1 X168 E4.989 F6000\nG1 Z1 F1200\n\n;===== extrude cali test ===============================\n;M400\n;    M900 S\n;\n;    M900 C\n;    G90\n;    M83\n;    G1 X78.000 Y1.000 F30000\n;    G1 Z0.200 F1200\n;    G1 X83.000 E0.16630 F{outer_wall_volumetric_speed*0.4 /(0.2*0.4) * 60}\n;    G1 X88.000 E0.16630 F{outer_wall_volumetric_speed*1.0 /(0.2*0.4) * 60}\n;    G1 X93.000 E0.16630 F{outer_wall_volumetric_speed*0.4 /(0.2*0.4) * 60}\n;    G1 X98.000 E0.16630 F{outer_wall_volumetric_speed*1.0 /(0.2*0.4) * 60}\n;    G1 X103.000 E0.16630 F{outer_wall_volumetric_speed*0.4 /(0.2*0.4) * 60}\n;    G1 X108.000 E0.16630 F{outer_wall_volumetric_speed*1.0 /(0.2*0.4) * 60}\n;    G1 X113.000 E0.16630 F{outer_wall_volumetric_speed*0.4 /(0.2*0.4) * 60}\n;    G1 X118.000 E0.16630 F{outer_wall_volumetric_speed*1.0 /(0.2*0.4) * 60}\n;    G1 X123.000 E0.16630 F{outer_wall_volumetric_speed*0.4 /(0.2*0.4) * 60}\n;    G1 X128.000 E0.16630 F{outer_wall_volumetric_speed*1.0 /(0.2*0.4) * 60}\n;    G1 X133.000 E0.16630 F{outer_wall_volumetric_speed*0.4 /(0.2*0.4) * 60}\n;    G1 X138.000 E0.16630 F{outer_wall_volumetric_speed*1.0 /(0.2*0.4) * 60}\n;    G1 X143.000 E0.16630 F{outer_wall_volumetric_speed*0.4 /(0.2*0.4) * 60}\n;    G1 X148.000 E0.16630 F{outer_wall_volumetric_speed*1.0 /(0.2*0.4) * 60}\n;    G1 X153.000 E0.16630 F{outer_wall_volumetric_speed*0.4 /(0.2*0.4) * 60}\n;    G1 X158.000 E0.16630 F{outer_wall_volumetric_speed*1.0 /(0.2*0.4) * 60}\n;    G1 X163.000 E0.16630 F{outer_wall_volumetric_speed*0.4 /(0.2*0.4) * 60}\n;    G1 X168.000 E0.16630 F{outer_wall_volumetric_speed*1.0 /(0.2*0.4) * 60}\n;    G1 X173.000 E0.16630 F{outer_wall_volumetric_speed*0.4 /(0.2*0.4) * 60}\n;    G1 X178.000 E0.16630 F{outer_wall_volumetric_speed*1.0 /(0.2*0.4) * 60}\n;    G1 X179 Z0\n;    G1 X183\n;    G1 Z1\n;    M400\n;\n;    M900 R\n    G90\n    M83\n    G1 X78.000 Y2.000 F30000\n    G1 Z0.200 F1200\n    G1 X83.000 E0.16630 F{outer_wall_volumetric_speed*0.4 /(0.2*0.4) * 60}\n    G1 X88.000 E0.16630 F{outer_wall_volumetric_speed*1.0 /(0.2*0.4) * 60}\n    G1 X93.000 E0.16630 F{outer_wall_volumetric_speed*0.4 /(0.2*0.4) * 60}\n    G1 X98.000 E0.16630 F{outer_wall_volumetric_speed*1.0 /(0.2*0.4) * 60}\n    G1 X103.000 E0.16630 F{outer_wall_volumetric_speed*0.4 /(0.2*0.4) * 60}\n    G1 X108.000 E0.16630 F{outer_wall_volumetric_speed*1.0 /(0.2*0.4) * 60}\n    G1 X113.000 E0.16630 F{outer_wall_volumetric_speed*0.4 /(0.2*0.4) * 60}\n    G1 X118.000 E0.16630 F{outer_wall_volumetric_speed*1.0 /(0.2*0.4) * 60}\n    G1 X123.000 E0.16630 F{outer_wall_volumetric_speed*0.4 /(0.2*0.4) * 60}\n    G1 X128.000 E0.16630 F{outer_wall_volumetric_speed*1.0 /(0.2*0.4) * 60}\n    G1 X133.000 E0.16630 F{outer_wall_volumetric_speed*0.4 /(0.2*0.4) * 60}\n    G1 X138.000 E0.16630 F{outer_wall_volumetric_speed*1.0 /(0.2*0.4) * 60}\n    G1 X143.000 E0.16630 F{outer_wall_volumetric_speed*0.4 /(0.2*0.4) * 60}\n    G1 X148.000 E0.16630 F{outer_wall_volumetric_speed*1.0 /(0.2*0.4) * 60}\n    G1 X153.000 E0.16630 F{outer_wall_volumetric_speed*0.4 /(0.2*0.4) * 60}\n    G1 X158.000 E0.16630 F{outer_wall_volumetric_speed*1.0 /(0.2*0.4) * 60}\n    G1 X163.000 E0.16630 F{outer_wall_volumetric_speed*0.4 /(0.2*0.4) * 60}\n    G1 X168.000 E0.16630 F{outer_wall_volumetric_speed*1.0 /(0.2*0.4) * 60}\n    G1 X173.000 E0.16630 F{outer_wall_volumetric_speed*0.4 /(0.2*0.4) * 60}\n    G1 X178.000 E0.16630 F{outer_wall_volumetric_speed*1.0 /(0.2*0.4) * 60}\n    G1 X179 Z0\n    G1 X183\n    G1 Z1\n    M400\n\nG1 Z0.2\n\n;===== wait chamber temperature reaching the reference value =======\n{if (overall_chamber_temperature >= 40)}\nM191 S[overall_chamber_temperature] ; wait for chamber temp\n{endif}\n\n;========turn off light and wait extrude temperature =============\nM1002 gcode_claim_action : 0\nM400\n\n;===== for Textured PEI Plate , lower the nozzle as the nozzle was touching topmost of the texture when homing ==\n;curr_bed_type={curr_bed_type}\n{if curr_bed_type==\"Textured PEI Plate\"}\nG29.1 Z{-0.02} ; for Textured PEI Plate\n{endif}\n\nM960 S1 P0 ; turn off laser\nM960 S2 P0 ; turn off laser\nM106 S0 ; turn off fan\nM106 P2 S0 ; turn off big fan\n{if (filament_type[initial_no_support_extruder]==\"PLA\") || (filament_type[initial_no_support_extruder]==\"PETG\") || (filament_type[initial_no_support_extruder]==\"TPU\") || (filament_type[initial_no_support_extruder]==\"PVA\") || (filament_type[initial_no_support_extruder]==\"PLA-CF\") || (filament_type[initial_no_support_extruder]==\"PETG-CF\")|| (filament_type[initial_no_support_extruder]==\"Support W\")}\nM142 P1 R35 S40 U0.3 V0.5 ; set chamber autocooling\n{else}\nM106 P3 S0 ; turn off chamber fan\n{endif}\n\nM975 S1 ; turn on mech mode supression\nG90\nM83\nT1000\n\nM211 X0 Y0 Z0 ;turn off soft endstop\nG29.4\n\n;============set motor current==================\nM17 X2.0 Y2.0 Z0.75\nM400 S1\n\n\n;====== cog noise reduction=================\n;M982.2 S0 ; turn on cog noise reduction\n\n;====== enable hotend clog detect =================\nM1015.3 S1 H[nozzle_diameter]\n;====== enable air print detect ====================\nM1015.4 S1 H[nozzle_diameter]\n"
}